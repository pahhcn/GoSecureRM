# GoSecureRM 客户端程序

## 概述

GoSecureRM 客户端是一个轻量级的远程管理代理程序，采用 Go 语言开发。该客户端程序设计用于接收服务端的管理指令，并在本地执行相应的操作，为系统管理员提供高效的远程运维能力。

## 核心功能

### 1. 远程命令执行
- 支持接收并执行服务端发送的系统命令
- 自动处理中文编码转换（GBK to UTF-8）
- 实时返回命令执行结果

### 2. 文件传输服务
- **双向文件传输** - 支持上传文件到服务端和从服务端下载文件
- **大文件支持** - 可处理任意大小的文件传输
- **断线重连** - 网络中断后自动重新连接

### 3. 系统监控功能
- **实时截图** - 定期或按需捕获屏幕截图
- **文件列表** - 提供本地文件系统浏览功能
- **系统信息** - 收集和上报硬件及软件配置信息

### 4. 安全特性
- **TLS 加密通信** - 所有数据传输均采用 TLS 加密
- **沙箱检测** - 内置反调试和虚拟环境检测机制
- **隐蔽运行** - 支持无窗口后台运行模式

## 项目结构

```
client/
├── cli.go          # 主程序入口和核心逻辑
├── pdf.go          # PDF 文档查看器模块
├── sandbox.go      # 安全沙箱和反调试检测
├── ico.ico         # 程序图标文件
├── go.mod          # Go 模块依赖配置
├── go.sum          # 依赖包版本锁定
├── README.md       # 客户端使用说明
└── rsrc.syso       # Windows 平台资源文件
```

## 安装与配置

### 环境准备

1. **Go 环境** - 确保安装了 Go 1.19 或更高版本
2. **网络连接** - 确保能够访问服务端地址和端口
3. **操作权限** - 部分功能需要管理员权限运行

### 编译客户端

1. 下载源代码到本地目录
2. 进入客户端目录并安装依赖：

```bash
cd client
go mod tidy
```

3. 编译生成可执行文件：

```bash
go build -o GoSecureRM-Client.exe cli.go
```

### 配置连接参数

在 `cli.go` 文件中修改服务器连接信息：

```go
// 修改服务器IP地址和端口
serverIP := "192.168.10.1:50050"
```

**注意：** 确保指定的服务器地址可以正常访问，且服务端程序已启动。

## 运行方式

### 标准运行模式

直接运行编译后的可执行文件：

```bash
./GoSecureRM-Client.exe
```

### 后台运行模式

Windows 平台下隐藏控制台窗口运行：

```bash
go build -ldflags="-H windowsgui" -o GoSecureRM-Client.exe cli.go
```

### 自启动配置

可以将客户端程序添加到系统启动项，实现开机自动运行：

1. **Windows** - 将程序快捷方式放入启动文件夹
2. **Linux** - 添加到 `/etc/rc.local` 或创建 systemd 服务
3. **macOS** - 使用 launchd 配置自启动

## 使用说明

### 连接流程

1. 客户端启动后自动尝试连接服务端
2. 建立 TLS 加密连接，验证证书有效性
3. 连接成功后进入待机状态，等待服务端指令
4. 如连接中断，客户端会每60秒自动尝试重连

### 支持的指令

- `SEND_FILE_TO_SERVER` - 上传指定文件到服务端
- `FILE_TRANSFER_TO_CLI_START` - 接收服务端下发的文件
- `captureScreenshottoserver` - 截取屏幕并上传到服务端
- `LIST_FILES` - 获取当前目录文件列表
- 其他系统命令 - 直接执行并返回结果

## 高级配置

### 自定义图标

1. 准备 ICO 格式的图标文件
2. 安装 rsrc 工具：

```bash
go install github.com/akavel/rsrc@latest
```

3. 生成资源文件：

```bash
rsrc -ico your-icon.ico -o rsrc.syso
```

4. 重新编译程序应用新图标

### 性能优化

- **内存使用** - 程序运行时内存占用约 10-20MB
- **CPU 占用** - 待机状态下 CPU 使用率接近 0%
- **网络流量** - 仅在执行任务时产生网络传输

## 故障排除

### 常见问题及解决方案

#### 1. 连接失败

**现象：** 客户端无法连接到服务端

**解决方法：**
- 检查服务端是否正常启动
- 验证网络连通性（ping 服务端IP）
- 确认防火墙未阻止相关端口
- 检查 IP 地址和端口配置是否正确

#### 2. 依赖包安装失败

**现象：** 编译时提示依赖包下载失败

**解决方法：**
```bash
# 清理模块缓存
go clean -modcache
# 重新下载依赖
go mod download
# 整理依赖关系
go mod tidy
```

#### 3. 权限不足

**现象：** 某些功能无法正常使用

**解决方法：**
- Windows：以管理员身份运行程序
- Linux/macOS：使用 sudo 运行或调整文件权限

#### 4. 中文乱码问题

**现象：** 命令输出出现乱码

**解决方法：**
程序已内置 GBK 到 UTF-8 的编码转换，如仍有问题请检查：
- 系统区域设置
- 控制台代码页配置

## 安全注意事项

1. **网络安全** - 建议仅在可信内网环境中使用
2. **权限管理** - 避免在生产环境中使用过高权限运行
3. **日志记录** - 定期检查程序运行日志，及时发现异常
4. **版本更新** - 定期更新到最新版本以获得安全修复

## 开发与贡献

如需对客户端进行二次开发或功能扩展，请参考以下指导：

1. 熟悉 Go 语言基础语法
2. 了解网络编程和 TLS 协议
3. 遵循项目现有的代码风格和架构
4. 充分测试新增功能的稳定性和安全性

## 许可协议

本项目基于 MIT 许可证开源，详细内容请查看 LICENSE 文件。

---

**免责声明：** 本工具仅供学习研究和合法的系统管理用途，使用者应遵守当地法律法规，对使用本工具产生的任何后果自行承担责任。
